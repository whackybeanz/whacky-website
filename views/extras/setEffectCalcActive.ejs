<%- include("../partials/header") %>
<%- include("../partials/navbar") %>

<div class="container-fluid content d-flex flex-column flex-md-row p-0">
	<%- include("../partials/sidebar") %>
	<div class="main-content-div col p-0 position-relative">
		<div class="w-100 d-flex align-items-center flex-column px-4 pt-4" id="calculator">
			<div class="w-100 d-flex justify-content-center align-items-center flex-column px-lg-4 pb-3">
				<div class="w-100 d-flex justify-content-center align-items-center position-relative mb-2">
					<div class="w-100 flex-grow-1 border-top border-dark"></div>
					<h1 class="font-header w-100 text-center m-0 px-0">Set Effects Calculator</h1>
					<div class="w-100 flex-grow-1 border-top border-dark"></div>
				</div>
				<div class="w-100 mb-3">
					<h2 class="font-subheader w-100 font-weight-bold text-underline mb-2">Instructions</h2>
					<div class="font-content w-100 d-flex justify-content-center align-items-center flex-column mb-4">
						<p class="w-100 text-justify">This calculator will display all the set effects your character has based on what items are equipped.</p>
					</div>
					<div class="font-content w-100 d-flex justify-content-center align-items-center flex-column mb-4">
						<h3 class="w-100 font-subsubheader font-italic mb-0">Step 1: Select your character's job type</h3>
						<div class="w-100 d-flex justify-content-center align-items-center flex-column position-relative">
							<div class="job-choice-div w-100 d-flex justify-content-center align-items-center py-3">
								<div class="single-option-select text-center rounded-sm position-relative py-1 px-2 mx-2 <% if(jobType === "warrior") { %>active<% } %>" data-job-select="warrior">
									<a href="./maple/calc/set-effects/warrior" class="stretched-link text-decoration-none">Warrior</a>
								</div>
								<div class="single-option-select text-center rounded-sm position-relative py-1 px-2 mx-2 <% if(jobType === "mage") { %>active<% } %>" data-job-select="mage">
									<a href="./maple/calc/set-effects/mage" class="stretched-link text-decoration-none">Mage</a>
								</div>
								<div class="single-option-select text-center rounded-sm position-relative py-1 px-2 mx-2 <% if(jobType === "archer") { %>active<% } %>" data-job-select="archer">
									<a href="./maple/calc/set-effects/archer" class="stretched-link text-decoration-none">Archer</a>
								</div>
								<div class="single-option-select text-center rounded-sm position-relative py-1 px-2 mx-2 <% if(jobType === "thief") { %>active<% } %>" data-job-select="thief">
									<a href="./maple/calc/set-effects/thief" class="stretched-link text-decoration-none">Thief</a>
								</div>
								<div class="single-option-select text-center rounded-sm position-relative py-1 px-2 mx-2 <% if(jobType === "pirate") { %>active<% } %>" data-job-select="pirate">
									<a href="./maple/calc/set-effects/pirate" class="stretched-link text-decoration-none">Pirate</a>
								</div>
							</div>
						</div>
					</div>
					<div class="step-2-div font-content w-100 d-flex flex-column mb-4">
						<h3 class="w-100 font-subsubheader font-italic mb-0">Step 2: Fill in your equipment setup</h3>
						<p class="text-justify">Click on any of the squares on the equipment window to begin. A popup will appear for selection of equipment sorted by item type. Once selection is complete, close the window and scroll down for the calculated values.</p>
						<p class="text-justify"><strong>Note:</strong> When adding pendants, the first item selected will be added to the regular Pendant slot. Rings will always be added from the top-most slot first regardless of which slot is initially selected.</p>
						<p class="text-justify"><strong>Note 2:</strong> For Zeros, select your weapon based on what set you'd like to take effect. For example, if you are using an ACS weapon but have used a Lucky Scroll to apply to the Fafnir set, please select a Fafnir weapon instead.</p>
						<div class="w-100 d-flex justify-content-center">
							<div class="position-relative">
								<img src="./public/images/equips/equip-tab.png">
								<div class="w-100 h-100 position-absolute" id="equip-grid">
									<div class="equip-slot" id="ring-1-slot" data-equip-type-index="0" data-equip-type="ring" data-toggle="modal" data-target="#setItemSelectModal"></div>
									<div class="equip-slot" id="ring-2-slot" data-equip-type-index="0" data-equip-type="ring" data-toggle="modal" data-target="#setItemSelectModal"></div>
									<div class="equip-slot" id="ring-3-slot" data-equip-type-index="0" data-equip-type="ring" data-toggle="modal" data-target="#setItemSelectModal"></div>
									<div class="equip-slot" id="ring-4-slot" data-equip-type-index="0" data-equip-type="ring" data-toggle="modal" data-target="#setItemSelectModal"></div>
									<div class="equip-slot" id="pocket-slot" data-equip-type-index="1" data-equip-type="pocket" data-toggle="modal" data-target="#setItemSelectModal"></div>

									<div class="equip-slot" id="pendant-2-slot" data-equip-type-index="2" data-equip-type="pendant" data-toggle="modal" data-target="#setItemSelectModal"></div>
									<div class="equip-slot" id="pendant-1-slot" data-equip-type-index="2" data-equip-type="pendant" data-toggle="modal" data-target="#setItemSelectModal"></div>
									<div class="equip-slot" id="weapon-slot" data-equip-type-index="3" data-equip-type="weapon" data-toggle="modal" data-target="#setItemSelectModal"></div>
									<div class="equip-slot" id="belt-slot" data-equip-type-index="4" data-equip-type="belt" data-toggle="modal" data-target="#setItemSelectModal"></div>

									<div class="equip-slot" id="hat-slot" data-equip-type-index="5" data-equip-type="hat" data-toggle="modal" data-target="#setItemSelectModal"></div>
									<div class="equip-slot" id="face-slot" data-equip-type-index="6" data-equip-type="face" data-toggle="modal" data-target="#setItemSelectModal"></div>
									<div class="equip-slot" id="eye-slot" data-equip-type-index="7" data-equip-type="eye" data-toggle="modal" data-target="#setItemSelectModal"></div>
									<div class="equip-slot" id="top-slot" data-equip-type-index="8" data-equip-type="top" data-toggle="modal" data-target="#setItemSelectModal"></div>
									<div class="equip-slot" id="bottom-slot" data-equip-type-index="9" data-equip-type="bottom" data-toggle="modal" data-target="#setItemSelectModal"></div>
									<div class="equip-slot" id="shoes-slot" data-equip-type-index="10" data-equip-type="shoes" data-toggle="modal" data-target="#setItemSelectModal"></div>

									<div class="equip-slot" id="earring-slot" data-equip-type-index="11" data-equip-type="earring" data-toggle="modal" data-target="#setItemSelectModal"></div>
									<div class="equip-slot" id="shoulder-slot" data-equip-type-index="12" data-equip-type="shoulder" data-toggle="modal" data-target="#setItemSelectModal"></div>
									<div class="equip-slot" id="gloves-slot" data-equip-type-index="13" data-equip-type="gloves" data-toggle="modal" data-target="#setItemSelectModal"></div>
									<div class="equip-slot" id="android-slot" data-equip-type-index="14" data-equip-type="android" data-toggle="modal" data-target="#setItemSelectModal"></div>

									<div class="equip-slot" id="emblem-slot" data-equip-type-index="15" data-equip-type="emblem" data-toggle="modal" data-target="#setItemSelectModal"></div>
									<div class="equip-slot" id="badge-slot" data-equip-type-index="16" data-equip-type="badge" data-toggle="modal" data-target="#setItemSelectModal"></div>
									<div class="equip-slot" id="medal-slot" data-equip-type-index="17" data-equip-type="medal" data-toggle="modal" data-target="#setItemSelectModal"></div>
									<div class="equip-slot" id="secondary-slot" data-equip-type-index="18" data-equip-type="secondary" data-toggle="modal" data-target="#setItemSelectModal"></div>
									<div class="equip-slot" id="cape-slot" data-equip-type-index="19" data-equip-type="cape" data-toggle="modal" data-target="#setItemSelectModal"></div>
									<div class="equip-slot" id="heart-slot" data-equip-type-index="20" data-equip-type="heart" data-toggle="modal" data-target="#setItemSelectModal"></div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="w-100 mb-3">
					<h2 class="font-subheader w-100 font-weight-bold text-underline mb-2">Total Set Effects</h2>
					<div class="font-content w-100 d-flex justify-content-center align-items-center flex-column mb-4">
						<p class="no-set-effect-msg font-content w-100 d-flex justify-content-center">- No active set effects -</p>
						<div class="font-table w-100 d-flex flex-wrap">
							<% statTypes.forEach(function(stat) { %>
								<div class="total-stat total-stat-<%= stat.key %> col-6 col-lg-4 d-none justify-content-between align-items-center p-0 my-1">
									<div class="col-7 font-weight-bold text-right p-0"><%= stat.name %></div>
									<div class="col-5 pl-3">+<span class="total-stat-<%= stat.key %>-val"></span><%= stat.symbol %></div>
								</div>
							<% }) %>
						</div>
					</div>
				</div>
				<div class="w-100 mb-3">
					<h2 class="font-subheader w-100 font-weight-bold text-underline mb-2">Set Effects Breakdown</h2>
					<div class="font-small w-100 d-flex flex-wrap justify-content-start align-items-start mb-4">
						<p class="no-active-set-msg font-content w-100 d-flex justify-content-center">- No active sets -</p>
						<% Object.keys(allSetEffects).forEach(function(jobType) { %>
						<% Object.keys(allSetEffects[jobType]).forEach(function(setName) { %>
							<div class="set-item-effect-div <%= setName %>-set col-6 col-lg-4 d-none mb-3" data-set-name="<%= setName %>">
								<div class="single-set-effect w-100 d-flex flex-column rounded-lg py-2 px-3">
									<h3 class="font-subsubheader text-center">&lt;<%= allSetEffects[jobType][setName].title %>&gt;</h3>
									<div class="set-items">
										<div class="set-effect lucky-item text-success d-none"></div>
										<% Object.keys(allSetEffects[jobType][setName].items).forEach(function(equipType) { %> 
										<% if(equipType === "weapon") { %>
											<div class="set-effect wearing-<%= equipType %> choose-weapon-text">Choose 1 weapon</div>
										<% } %>
										<% allSetEffects[jobType][setName].items[equipType].forEach(function(item) { %>
										<div class="set-effect wearing-<%= equipType %> <% if(equipType === "weapon") { %>d-none<% } %>" id="item-<%= item.id %>"><%= item.name %></div>
										<% }) %>
										<% }) %>
									</div>
									<hr>
									<div class="num-wearing-div">
										<% Object.keys(allSetEffects[jobType][setName].effects).forEach(function(numEquipped) { %> 
										<div class="set-effect wearing-<%= numEquipped %> d-flex flex-column mb-2">
											<p class="mb-0"><%= numEquipped %> set effect:</p>
											<% allSetEffects[jobType][setName].effects[numEquipped].forEach(function(effect) { %>
												<div class="single-effect" data-stat-id="<%= effect.statId %>" data-stat-val="<%= effect.val %>">
													<%= effect.statName %> +<%= effect.val %><%= effect.symbol %>
												</div>
											<% }) %>
										</div>
										<% }) %>
									</div>
								</div>
							</div>
						<% }) %>
						<% }) %>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="setItemSelectModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
	<div class="set-item-modal-dialog modal-dialog modal-dialog-centered modal-dialog-scrollable px-2 pb-5" role="document">
		<div class="modal-content">
			<div class="modal-header position-relative">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<p class="slot-exceed-msg font-small w-100 position-absolute text-center text-danger m-0"></p>
			</div>
			<div class="modal-body p-0">
				<div id="carousel-fade" class="carousel carousel-fade rounded-sm" data-ride="carousel" data-interval="false">
					<div class="carousel-inner position-relative">
						<% allEquipTypes.forEach(function(equipType, index) { %>
						<div class="equip-select-div equip-select-<%= equipType %> carousel-item pt-2 pb-3 px-3">
							<div class="carousel-caption w-100 p-0">
								<h2 class="carousel-header font-subheader w-100 font-weight-bold text-center text-capitalize text-decoration-none"></h2>
								<div class="font-table w-100 d-flex flex-wrap">
								<% Object.keys(allSetItems).forEach(function(jobType, index) { %>
								<% if(allSetItems[jobType][equipType]) { %>
									<% allSetItems[jobType][equipType].forEach(function(item) { %> 
									<div class="equip-choice col-12 col-sm-6 col-lg-6 w-100 mb-2 px-2 d-flex">
										<div class="single-option-select single-equip-choice single-equip-<%= equipType %> w-100 d-flex align-items-center rounded-sm" data-equip-name="<%= item.name %>" data-set-type="<%= item.setType %>" data-equip-type="<%= equipType %>" data-choice-img="<%= item.image %>" data-item-id="<%= item.id %>" <% if(item.isLuckyItem) { %>data-is-lucky-item="<%= item.isLuckyItem %>" data-item-priority="<%= item.itemPriority %>" <% } %> <% if(item.isOverall) { %>data-is-overall="<%= item.isOverall %>"<% } %>>
											<div class="equip-choice-img-div inline-div-img h-100 mr-2 d-flex justify-content-center align-items-center">
												<img src="<%= item.image %>" class="m-2">
											</div>
											<p class="equip-name m-0 mr-2 text-left"><%= item.name %></p>
										</div>
									</div>
									<% }) %>
								<% } %>
								<% }) %>
								</div>
							</div> 
						</div>
						<% }) %>
					</div>
				</div>
			</div>
			<div class="modal-footer py-1">
				<div class="carousel-control w-100 position-relative">
					<a class="carousel-control-prev h-100 w-auto px-2" href="#carousel-fade" role="button" data-slide="prev">
						<i class="fas fa-angle-double-left d-flex align-items-center mr-1"></i>
						<span class="sr-only">Previous</span>
						<p class="font-weight-bold mb-1 carousel-control-prev-text"></p>
					</a>
					<a class="carousel-control-next h-100 w-auto px-2" href="#carousel-fade" role="button" data-slide="next">
						<p class="font-weight-bold mb-1 carousel-control-next-text"></p>
						<i class="fas fa-angle-double-right d-flex align-items-center ml-1"></i>
						<span class="sr-only">Next</span>
					</a>
				</div>
			</div>
		</div>
	</div>
</div>

<script type="text/javascript" src="./public/scripts/setEffectScript.js"></script>
<%- include("../partials/footer") %>