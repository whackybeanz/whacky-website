<%- include("../../partials/header") %>
<%- include("../../partials/navbar") %>

<div class="container-fluid content d-flex flex-column flex-md-row p-0">
    <%- include("../../partials/sidebar") %>

    <div class="main-content-div col px-0 position-relative">
        <div class="w-100 d-flex align-items-center flex-column px-4 pt-4">
            <div class="w-100 d-flex justify-content-center align-items-center flex-column px-lg-4 pb-3">
                <div class="w-100 d-flex justify-content-center align-items-center position-relative mb-0">
                    <div class="w-100 flex-grow-1 border-top border-dark"></div>
                    <h1 class="font-header w-100 text-center m-0 px-0">Coin Event Details - <span id="event-name"><%= coinEventData.eventDetails.name %></span></h1>
                    <div class="w-100 flex-grow-1 border-top border-dark"></div>
                </div>

                <img class="coin-event-banner small mb-0" src="https://whacky-website.s3-ap-southeast-1.amazonaws.com/images/event/coin-events/<%= coinEventData.eventDetails.bannerImg %>">
                <small>
                    <%= coinEventData.eventDetails.startDate.toLocaleDateString('en-SG', {month: 'short', day: '2-digit', year: 'numeric' }) %> to 
                    <%= coinEventData.eventDetails.endDate.toLocaleDateString('en-SG', {month: 'short', day: '2-digit', year: 'numeric' }) %>
                </small>
                <small class="mb-2">
                    (<%= durationWeeks %> weeks / <%= durationWeeks * 7 %> days)
                </small>

                <div class="w-100 d-flex justify-content-start mb-5">
                    <a href="/maple/events/coin-events" class="btn btn-sm btn-outline-info px-3"><i class="fas fa-angle-double-left"></i> Back to Coin Events List</a>
                </div>

                <div class="w-100 mb-3">
                    <h2 class="font-subheader w-100 font-weight-bold text-underline mb-2">Instructions</h2>
                    <div class="font-content w-100 d-flex justify-content-center align-items-center flex-column mb-4">
                        <p class="w-100 text-justify">Click on Shopping Cart, Shop List or Coin Breakdown buttons to view respective details. You can save up to five profiles worth of shopping data. To save data to that profile, click on the save icon (bottom right). The active profile that data is saved to is displayed to the left of the icon. Click on the profile name to rotate between each profile.</p>
                    </div>
                </div>

                <div class="w-100">
                    <ul class="nav nav-pills d-flex justify-content-center mb-4" id="coinEventTabs" role="tablist">
                        <li class="nav-item mx-1">
                            <a class="single-section-select nav-link active" href="#expense-summary" id="expense-summary-pill" data-toggle="pill" role="tab">Expense Summary</a>
                        </li>
                        <li class="nav-item mx-1">
                            <a class="single-section-select nav-link" href="#shop-item-list" id="shop-item-list-pill" data-toggle="pill" role="tab">Item List</a>
                        </li>
                        <li class="nav-item mx-1">
                            <a class="single-section-select nav-link" href="#cart" id="cart-pill" data-toggle="pill" role="tab">Shopping Cart</a>
                        </li>
                        <li class="nav-item mx-1">
                            <a class="single-section-select nav-link" href="#coin-breakdown" id="coin-breakdown-pill" data-toggle="pill" role="tab">Coin Breakdown</a>
                        </li>
                    </ul>

                    <div class="w-100 tab-content d-flex justify-content-center py-3" id="coinEventTabsContent">
                        <div class="w-100 tab-pane border-0 fade show active" id="expense-summary" role="tabpanel" aria-labelledby="cart-tab">
                            <%- include("./expenseSummary") %>
                        </div>
                        <div class="w-100 tab-pane border-0 fade" id="shop-item-list" role="tabpanel" aria-labelledby="shop-item-list-tab">
                            <form class="w-100 mb-4 mb-lg-0">
                                <input type="hidden" value="<%= coinEventData.eventId %>" id="event-id">

                                <div class="d-flex justify-content-center px-3">
                                    <div class="size-350 w-100 form-group row d-flex align-items-center">
                                        <label class="col-5 font-weight-bold px-2 mb-0 text-left text-sm-center" for="shop-select">Select shop:</label>
                                        <select class="col-7 form-control px-2 py-0" id="shop-select">
                                            <% coinEventData.shops.forEach((shop, index) => { %>
                                                <option value="<%= index %>"><%= shop.shopName %></option>
                                            <% }) %>
                                        </select>
                                    </div>
                                </div>

                                <% coinEventData.shops.forEach((shop, index) => { %>
                                    <%- include("./coinShopItemList", { shop: shop, index: index }) %>
                                <% }) %>
                            </form>
                        </div>
                        <div class="w-100 tab-pane border-0 fade" id="cart" role="tabpanel" aria-labelledby="cart-tab">
                            <%- include("./shoppingCart") %>
                        </div>
                        <div class="w-100 tab-pane border-0 fade" id="coin-breakdown" role="tabpanel" aria-labelledby="coin-breakdown-tab">
                            <div class="d-flex justify-content-center">
                                <div class="size-900 w-100">
                                    <%- include("./coinSummary") %>
                                </div>
                            </div>
                            <%- include("../../admin/coin-events/coin/coinBreakdownDetails") %>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="d-none" id="save-container">
        <div class="font-small position-fixed cursor-pointer rounded-lg text-center border-right-0" id="active-profile">
            <% for(let i = 0; i < 10; i++) { %>
                <div class="w-100 single-profile-name px-2 py-1 <% if(i !== 0) { %>d-none<% } else { %>active<% } %>" id="active-profile-<%= i %>-name" data-profile-num="<%= i %>"></div>
            <% } %>
        </div>

        <div class="modal-btn-trigger position-fixed cursor-pointer d-flex justify-content-center align-items-center" id="btn-save">
            <i class="save-icon far fa-lg fa-save"></i>
            <i class="save-success-icon fas fa-lg fa-check d-none"></i>
        </div>
    </div>
</div>

<script type="text/javascript" src="/scripts/commonScript.js"></script>
<script type="text/javascript" src="/scripts/more-maple/coinEventScript.js"></script>
<%- include("../../partials/footer") %>