<%- include("../../partials/header") %>

<div class="container-fluid content d-flex flex-column flex-md-row p-0">
    <%- include("../../partials/sidebar") %>

    <div class="main-content-div col px-0 position-relative">
        <div class="w-100 d-flex align-items-center flex-column px-3 pt-4">
            <div class="w-100 d-flex justify-content-center align-items-center flex-column px-lg-4 pb-3">
                <div class="w-100 d-flex justify-content-center align-items-center position-relative mb-0">
                    <div class="w-100 flex-grow-1 border-top border-dark"></div>
                    <h1 class="font-header w-100 text-center m-0 px-0">Coin Event Details - <span id="event-name"><%= coinEventData.eventDetails.name %></span></h1>
                    <div class="w-100 flex-grow-1 border-top border-dark"></div>
                </div>
                <div class="col-12 text-muted text-center font-small mb-3">(Updated on 18 Nov 2021 - Added item tradability filtering in Item List)</div>

                <img class="coin-event-banner small mb-0" src="https://whacky-website.s3-ap-southeast-1.amazonaws.com/images/event/coin-events/<%= coinEventData.eventId %>/<%= coinEventData.eventDetails.bannerImg %>">
                <small>
                    <%= coinEventData.eventDetails.startDate.toLocaleDateString('en-SG', {month: 'short', day: '2-digit', year: 'numeric' }) %> to 
                    <%= coinEventData.eventDetails.endDate.toLocaleDateString('en-SG', {month: 'short', day: '2-digit', year: 'numeric' }) %>
                </small>
                <small class="mb-2">
                    (<%= durationWeeks %> weeks / <%= durationWeeks * 7 %> days)
                </small>

                <div class="w-100 d-flex justify-content-start mb-5">
                    <a href="/calc/coin-events" class="btn btn-sm btn-outline-custom d-flex align-items-center px-3">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-left-fill" viewBox="0 0 16 16">
                          <path d="m3.86 8.753 5.482 4.796c.646.566 1.658.106 1.658-.753V3.204a1 1 0 0 0-1.659-.753l-5.48 4.796a1 1 0 0 0 0 1.506z"/>
                        </svg>
                        Back to Coin Events List
                    </a>
                </div>

                <div class="w-100 d-flex justify-content-center align-items-center flex-column mb-4">
                    <div class="collapsible-section-subheader w-100">
                        <h3 class="font-subheader index-collapse d-flex align-items-center cursor-pointer mb-0 px-3 py-2 collapsed" data-toggle="collapse" href="#instructions">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-down-fill" viewBox="0 0 16 16">
                              <path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"/>
                            </svg>&nbsp;Guide / Instructions
                        </h3>
                    </div>
                    <div class="font-table collapsible-section w-100 px-3 collapse" id="instructions">
                        <div class="py-2">
                            <p class="w-100 font-weight-bold mb-1">Icon guide</p>
                            <ul>
                                <li>
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-info-circle-fill" viewBox="0 0 16 16">
                                      <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"/>
                                    </svg>
                                    Mouse over for more info
                                    </li>
                                <li>
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left-right" viewBox="0 0 16 16">
                                      <path fill-rule="evenodd" d="M1 11.5a.5.5 0 0 0 .5.5h11.793l-3.147 3.146a.5.5 0 0 0 .708.708l4-4a.5.5 0 0 0 0-.708l-4-4a.5.5 0 0 0-.708.708L13.293 11H1.5a.5.5 0 0 0-.5.5zm14-7a.5.5 0 0 1-.5.5H2.707l3.147 3.146a.5.5 0 1 1-.708.708l-4-4a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 4H14.5a.5.5 0 0 1 .5.5z"/>
                                    </svg>
                                    Inter-account Tradable
                                </li>
                                <li>
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="red" class="bi bi-slash-circle" viewBox="0 0 16 16">
                                      <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                                      <path d="M11.354 4.646a.5.5 0 0 0-.708 0l-6 6a.5.5 0 0 0 .708.708l6-6a.5.5 0 0 0 0-.708z"/>
                                    </svg>
                                    Untradable
                                </li>
                            </ul>
                            <p class="w-100 font-weight-bold mb-1">Expense Summary</p>
                            <ul>
                                <li>A summary of all expenses, split into each profile. Profiles can be renamed.</li>
                            </ul>
                            <p class="w-100 font-weight-bold mb-1">Item List</p>
                            <ul>
                                <li>Displays all shop items + rank up purchases. Click on the dropdown to select which shop to view. Enter the quantity for items you wish to purchase.</li>
                                <li>Click on the save button (bottom right) to save all item purchases to the active profile (shown beside the save button).</li>
                                <li>Click on the profile name beside the save button to rotate the current active profile.</li>
                            </ul>
                            <p class="w-100 font-weight-bold mb-1">Shopping Cart</p>
                            <ul>
                                <li>Displays all your item purchases, split by profile. Click on the dropdown to select which profile to view.</li>
                                <li>Click on "Load Profile to Item List" to load all expenses from the selected profile to the Item List tab. This will also set the loaded profile as the active one to be saved to.</li>
                            </ul>
                            <p class="w-100 font-weight-bold mb-1">Coin Breakdown</p>
                            <ul>
                                <li>Displays data regarding each coin, where to get them, maximum possible amounts, and rank up costs (if any).</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="w-100">
                    <ul class="nav nav-pills d-flex justify-content-center mt-3 mb-4" id="coinEventTabs" role="tablist">
                        <li class="nav-item mx-1">
                            <a class="single-section-select nav-link active" href="#expense-summary" id="expense-summary-pill" data-toggle="pill" role="tab">Expense Summary</a>
                        </li>
                        <li class="nav-item mx-1">
                            <a class="single-section-select nav-link" href="#shop-item-list" id="shop-item-list-pill" data-toggle="pill" role="tab">Item List</a>
                        </li>
                        <li class="nav-item mx-1">
                            <a class="single-section-select nav-link" href="#cart" id="cart-pill" data-toggle="pill" role="tab">Shopping Cart</a>
                        </li>
                        <li class="nav-item mx-1">
                            <a class="single-section-select nav-link" href="#coin-breakdown" id="coin-breakdown-pill" data-toggle="pill" role="tab">Coin Breakdown</a>
                        </li>
                        <% if(Object.keys(coinBossByName).length > 0) { %>
                            <li class="nav-item mx-1">
                                <a class="single-section-select nav-link" href="#boss-coin-calc" id="boss-coin-calc-pill" data-toggle="pill" role="tab">Boss Coin Calculator</a>
                            </li>
                        <% } %>
                    </ul>

                    <div class="w-100 tab-content d-flex justify-content-center py-3" id="coinEventTabsContent">
                        <div class="w-100 tab-pane border-0 fade show active" id="expense-summary" role="tabpanel" aria-labelledby="cart-tab">
                            <%- include("./expenseSummary") %>
                        </div>
                        <div class="w-100 tab-pane border-0 fade" id="shop-item-list" role="tabpanel" aria-labelledby="shop-item-list-tab">
                            <form class="w-100 mb-4 mb-sm-3 mb-md-0 d-flex flex-column align-items-center justify-content-center">
                                <input type="hidden" value="<%= coinEventData.eventId %>" id="event-id">

                                <div class="size-350 w-100 d-flex flex-column align-items-center justify-content-center">
                                    <div class="w-100 form-group row d-flex align-items-center">
                                        <label class="col-5 font-weight-bold px-2 mb-0 text-left" for="tradability-select">Item tradability</label>
                                        <select class="col-7 form-control px-2 py-0" id="tradability-select">
                                            <option value="all">Show all</option>
                                            <option value="tradable">Tradable</option>
                                            <option value="inter-acct">Inter-account Tradable</option>
                                            <option value="untradable">Untradable</option>
                                        </select>
                                    </div>
                                    <div class="w-100 form-group row d-flex align-items-center">
                                        <label class="col-5 font-weight-bold px-2 mb-0 text-left" for="shop-select">Select shop</label>
                                        <select class="col-7 form-control px-2 py-0" id="shop-select">
                                            <% coinEventData.shops.forEach((shop, index) => { %>
                                                <option value="<%= index %>"><%= shop.shopName %></option>
                                            <% }) %>

                                            <% if(coinEventData.coinDetails.some(coin => coin.isUsedForRankUp)) { %>
                                                <option value="rank-up">Rank Up Costs</option>
                                            <% } %>
                                        </select>
                                    </div>
                                </div>

                                <% coinEventData.shops.forEach((shop, index) => { %>
                                    <%- include("./coinShopItemList", { shop: shop, index: index }) %>
                                <% }) %>

                                <% if(coinEventData.coinDetails.some(coin => coin.isUsedForRankUp)) { %>
                                    <%- include("./rankUpCostItemList") %>
                                <% } %>

                                <div class="size-350 w-100 mb-3">
                                    <button class="btn-save w-100 btn btn-sm btn-outline-custom" type="button" id="btn-save-bottom">
                                        <p class="save-default-msg mb-0">Save expenses to current profile</p>
                                        <p class="save-success-msg d-none mb-0 align-items-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-check2" viewBox="0 0 16 16">
                                              <path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
                                            </svg>
                                            Saved!
                                        </p>
                                    </button>
                                </div>

                                <div class="size-350 w-100 mb-3 mb-md-0">
                                    <button class="w-100 btn btn-sm btn-outline-danger" type="button" id="btn-erase-inputs">
                                        <span class="erase-default-msg">Erase all Item List inputs</span>
                                        <span class="erase-success-msg d-none align-items-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-check2" viewBox="0 0 16 16">
                                              <path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
                                            </svg>
                                            Erased
                                        </span>
                                    </button>
                                </div>
                            </form>
                        </div>
                        <div class="w-100 tab-pane border-0 fade" id="cart" role="tabpanel" aria-labelledby="cart-tab">
                            <%- include("./shoppingCart") %>
                        </div>
                        <div class="w-100 tab-pane border-0 fade" id="coin-breakdown" role="tabpanel" aria-labelledby="coin-breakdown-tab">
                            <div class="d-flex justify-content-center">
                                <div class="size-900 w-100 d-flex flex-column align-items-center">
                                    <%- include("./coinSummary") %>
                                </div>
                            </div>
                            <%- include("../../admin/coin-events/coin/coinBreakdownDetails") %>
                        </div>
                        <% if(Object.keys(coinBossByName).length > 0) { %>
                            <div class="w-100 tab-pane border-0 fade" id="boss-coin-calc" role="tabpanel" aria-labelledby="boss-coin-calc-tab">
                                <%- include("./bossCoinCalc") %>
                            </div>
                        <% } %>
                    </div>
                </div>

                <!-- Horizontal -->
                <ins class="adsbygoogle ad-space horz-ad rounded-lg p-2 mb-3"
                     style="display:block"
                     data-ad-client="ca-pub-9569715514342803"
                     data-ad-slot="9935306861"
                     data-ad-format="auto"
                     data-full-width-responsive="true">
                         <p class="ad-space-text text-center font-bold font-small mb-0">Advertisement</p>
                     </ins>
                <script>
                    window.onload = function() {
                     (adsbygoogle = window.adsbygoogle || []).push({});
                    }
                </script>
            </div>
        </div>
    </div>

    <div class="d-none" id="save-container">
        <div class="font-small position-fixed cursor-pointer rounded-lg text-center border-right-0" id="active-profile">
            <% for(let i = 0; i < 10; i++) { %>
                <div class="w-100 single-profile-name px-2 py-1 <% if(i !== 0) { %>d-none<% } else { %>active<% } %>" id="active-profile-<%= i %>-name" data-profile-num="<%= i %>"></div>
            <% } %>
        </div>

        <div class="btn-save modal-btn-trigger position-fixed cursor-pointer d-flex justify-content-center align-items-center" id="btn-save-round">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="save-icon bi bi-save" viewBox="0 0 16 16">
              <path d="M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9.5a1 1 0 0 0-1 1v7.293l2.646-2.647a.5.5 0 0 1 .708.708l-3.5 3.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L7.5 9.293V2a2 2 0 0 1 2-2H14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h2.5a.5.5 0 0 1 0 1H2z"/>
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="save-success-icon bi bi-check2 d-none" viewBox="0 0 16 16">
              <path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
            </svg>
        </div>
    </div>
</div>

<script type="text/javascript" src="/scripts/commonScript.js"></script>
<script type="text/javascript" src="/scripts/more-maple/coinEventScript.js"></script>
<%- include("../../partials/footer") %>